--- #Gets Kong API settings -- requires bprc -- see https://github.com/bradwood/BPRC
recipe:
  -  # step0
    name: Get API details
    httpmethod: GET
    URL: http://kong:8001/apis
    # name: Load OAUTH Plugin
    # httpmethod: POST
    # URL: http://httpbin.org/post #gets the JSON field id from the body of the response from step 1.
    # request:
    #   querystring:
    #     key3: value3
    #     keysub: <%=steps[0].request.headers["Authorisation"]%>
    #   body:
    #     key4: valueprefix <%=steps[0].request.headers["X-ABC"]%>
    #   headers:
    #     blah: blahbha
    #     Authorisation: bearer <%=steps[0].request.querystring["keyb"]%>
    # response: # set up this response section if you need to pull out data here for use later in the recipe.
    #   code:
    #   body:
    #   headers:
    #     Authorisation:
    # response:
    #   total:
    #   data:
  -  # step1
    name: Get specific API details
    httpmethod: GET
    URL: http://kong:8001/apis/<%=steps[0].response.body["total"]%>

